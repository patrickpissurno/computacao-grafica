function multi(m1, m2) {
    const result = [];
    for (let i = 0; i < m1.length; i++) {
        result[i] = [];

        for (let j = 0; j < m2[0].length; j++) {
            let sum = 0;
            for (var k = 0; k < m1[0].length; k++)
                sum += m1[i][k] * m2[k][j];

            result[i][j] = sum;
        }
    }
    return result;
}

function deg(degrees) {
    return degrees * (Math.PI/180);
}

window.animation = {
    loop: false,
    keyframes: [
        {
            matrix: [
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ -2, 0, 1, 1 ],
            ],
            duration: 150
        },
        {
            matrix: multi(multi([
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 2, 0, -1, 1 ],
            ], [
                [ Math.cos(deg(30)), -Math.sin(deg(30)), 0, 0 ],
                [ Math.sin(deg(30)), Math.cos(deg(30)), 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 0, 0, 0, 1 ],
            ]), [
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ -2, 0, 1, 1 ],
            ]),
            duration: 150
        },
        {
            matrix: multi(multi([
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 2, 0, -1, 1 ],
            ], [
                [ Math.cos(deg(30)), -Math.sin(deg(30)), 0, 0 ],
                [ Math.sin(deg(30)), Math.cos(deg(30)), 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 0, 0, 0, 1 ],
            ]), [
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ -2, 0, 1, 1 ],
            ]),
            duration: 150
        },
        {
            matrix: multi(multi([
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 2, 0, -1, 1 ],
            ], [
                [ Math.cos(deg(30)), -Math.sin(deg(30)), 0, 0 ],
                [ Math.sin(deg(30)), Math.cos(deg(30)), 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 0, 0, 0, 1 ],
            ]), [
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ -2, 0, 1, 1 ],
            ]),
            duration: 150
        },
        {
            matrix: [
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 0, 0, 0, 1 ],
            ],
            duration: 150
        },
        {
            matrix: multi(multi([
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 2, 0, -1, 1 ],
            ], [
                [ 0.5, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 0, 0, 0, 1 ],
            ]), [
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ -2.25, 0, 1, 1 ],
            ]),
            duration: 1000
        },
        {
            matrix: multi(multi([
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 2.25, 0, 0, 1 ],
            ], [
                [ 2, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 0, 0, 0, 1 ],
            ]), [
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 2.1, 0, 0, 1 ],
            ]),
            duration: 500
        },
        {
            matrix: multi(multi([
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ -2.1, 0, 0, 1 ],
            ], [
                [ Math.cos(deg(-15)), -Math.sin(deg(-15)), 0, 0 ],
                [ Math.sin(deg(-15)), Math.cos(deg(-15)), 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 0, 0, 0, 1 ],
            ]), [
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 2.1, -0.2, 0, 1 ],
            ]),
            duration: 50
        },
        {
            matrix: multi(multi([
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ -2.1, 0.2, 0, 1 ],
            ], [
                [ Math.cos(deg(-5)), -Math.sin(deg(-5)), 0, 0 ],
                [ Math.sin(deg(-5)), Math.cos(deg(-5)), 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 0, 0, 0, 1 ],
            ]), [
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 1.9, -0.8, 0, 1 ],
            ]),
            duration: 300
        },
        {
            matrix: multi(multi([
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ -1.9, 0.8, 0, 1 ],
            ], [
                [ Math.cos(deg(-5)), -Math.sin(deg(-5)), 0, 0 ],
                [ Math.sin(deg(-5)), Math.cos(deg(-5)), 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 0, 0, 0, 1 ],
            ]), [
                [ 1, 0, 0, 0 ],
                [ 0, 1, 0, 0 ],
                [ 0, 0, 1, 0 ],
                [ 1.6, -1.7, 0, 1 ],
            ]),
            duration: 290
        },
    ]
};